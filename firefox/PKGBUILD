# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=firefox
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=35.0.1
pkgrel=1
pkgdesc="Standalone, easy to customize web browser"
url="http://www.mozilla.org/firefox/"
arch=('any')
license=('GPL' 'LGPL', 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip) # digital signatures
source=("FirefoxSetup.exe::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Firefox Setup ${pkgver}.exe"
        "ach.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ach.xpi"
        "af.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/af.xpi"
        "an.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/an.xpi"
        "ar.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "as.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/as.xpi"
        "ast.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "az.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/az.xpi"
        "be.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "bn-IN.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-IN.xpi"
        "br.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "bs.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bs.xpi"
        "ca.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "en-ZA.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-ZA.xpi"
        "eo.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eo.xpi"
        "es-AR.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-CL.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-CL.xpi"
        "es-ES.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "es-MX.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-MX.xpi"
        "et.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fa.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fa.xpi"
        "ff.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ff.xpi"
        "fi.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "gu-IN.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gu-IN.xpi"
        "he.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hi-IN.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hi-IN.xpi"
        "hr.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "kk.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/kk.xpi"
        "km.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/km.xpi"
        "kn.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/kn.xpi"
        "ko.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lij.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lij.xpi"
        "lt.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "lv.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lv.xpi"
        "mai.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/mai.xpi"
        "mk.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/mk.xpi"
        "ml.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ml.xpi"
        "mr.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/mr.xpi"
        "ms.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ms.xpi"
        "nb-NO.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "or.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/or.xpi"
        "pa-IN.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "son.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/son.xpi"
        "sq.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta.xpi"
        "te.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/te.xpi"
        "th.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/th.xpi"
        "tr.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "xh.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/xh.xpi"
        "zh-CN.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::ftp://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
md5sums=('4ad9b995001ff60f11c51d8d3c3f328d'
         '4b1826fe0d542c89e86ffcba6c240eba'
         '42582add937126c1602afaaa9440f068'
         '2a56e00ee3305cbe17db74225c1b7c1a'
         '2fc58a4240a53d9dc2a81fe79e24e642'
         '90f83ff6e27c547cc2232c5833a45868'
         'a947f9699825cfccda5767fad76977b7'
         '390e72b35bf75632ecf04aaf489df396'
         '6bf95a82b55932d15a106c7d5d2f492e'
         '253bb580ed407d9ac15978b178a0863c'
         '6de7a993085fc07f0fa5b20a998b5daa'
         '373c06985f1a48b7684e97e9a9dd08e3'
         '5c0147d9c9dd60031393a2408e43cf06'
         '484f2a6456b4ba29c44610b50a07c235'
         'd57dde999d65836e794b803eb708d0f8'
         '66badc70eb84359b5f3ea7a863d69dad'
         'bb8efd15849487522f72e25fe2c99d4a'
         'ca5b60b7ef8714a702add6d8c098d6fa'
         '5d7d90f0a9600ba29de24c9f8d92ddd9'
         '25ec22d0f71d9fd1b183bd4161d8d8ea'
         '62fa24e397841339c0aa4fc321ba4000'
         '8fce943d7b4101c0f5e6fbf3b4acbcf8'
         '8491fec33105aad2ea05c502868b5370'
         '336d72902b6c6e7133e6d9c1f0eefa52'
         'dbca4fada347c054d4f6a837b687d8a6'
         'b6f56501b7d0b63a8a2d592fb95687c6'
         '64a3a4b45d6f1973bab051514e2ea046'
         'c3b87a912dce078a39fdc37c8ce6f5b7'
         'a6b8fb0bfd82e59a8280bd60df3e38f5'
         '6dcdf227e3f134b8de46d01b8d0968df'
         '6dca4e9444c22d724e8e67fcc61bed44'
         '675fa779061bc7d8a48109793b4a64db'
         '38a822703ddf52ef63ab581399437b1e'
         '577319ae7a86420d319b3b8c2b506ab1'
         'e861ea49f6672b57bb2ac44b30046c05'
         '85e5f3f1dde164318eaa500e0000c3a8'
         '219580853a8c30548c2dd020f5c69018'
         'df0646b28105cd053e50bb650b98ee59'
         '0a093df74ff03f4aea8c91fcf9be4658'
         '281db36e8673f0ce674eb83b855487f7'
         '8a9622e63c1abb17ecdee7d904fb8216'
         'eba8898849658482e2331518ac690daa'
         '800b7a896be765c3d788387e27edd175'
         '7751cabd4c5fbbb55c191f0eee2b6b31'
         '122dfaaa30d4b5779adafb1fb4268e20'
         '0a2e0590c559f77b73926a169edfd12c'
         'ea263aeb97def1188066bbeaf2f6fe15'
         '7aa48a77ac39ba907505f18b586b4d89'
         'f99a7d526ff287e1d37487a9fd267715'
         'c6ea48b67473ad8121fd6f4e4b584c65'
         '1d2fbcb50e48499d8344088ea35c26fa'
         '4ba9180949fc18243b3e65806753849c'
         '798fc02186d8f48b21ec802b27161309'
         '97e6384ff3013bae334b0eb501ee235d'
         'd9db398311300fb875e4cc6751e03d03'
         '0f0f539a55219b8bfbbda913e1567cd4'
         '9a0bb706d5878e7dd5d5858ed6825ba5'
         '4c06da92f41c2e516464883c4feef3ad'
         '7e2b94c3a78c0e1be35c710f1d309ef8'
         '0a549985ef68e17d5bad1c0d433bc06d'
         '253c1870223aa061f279e06d1e7991dc'
         '3d4d39ed294da819becb8ba75e93558f'
         '8acefb72ae0547a265a8f0772ed4362d'
         'ff9f974b2bae0549c7ec59f21591ea9e'
         'acb2e93bf60a6cb3e0e727ad88ec593e'
         'a60410f894b29e7753f5211c42a8733d'
         '47f70982cb06c7baf69e1b10ed64dd61'
         '78f1a3e803a669c4fd6d2efce9b73a72'
         'a12d9a46176b0e4f96aa06dcfae9140a'
         '3a892f667c3c0f6182694660a1944a16'
         '1a73d9fe8b5823b102c7c13050679ab4'
         '66c1441498def93aef5cf38d55a4298f'
         'ea6ff195d3af849be55d15d58df3b675'
         '99ad6bc9f327529bbe5a2578e564bc9a'
         'e3e0567a1c5bbe88b5154cd9cb5d6c96'
         'd171c207aba11c346d3d7a414824977d'
         'bfa80a04c2e93bc2ae3eae9197a70dec'
         '873a09f84a403a462c07c68ba5ad00ec'
         '8375e222bc046e82dc59b55b53c37da3'
         'e44b4d634bfb3c3fd06e173f33deb394'
         '77c4c108b6315910ab35c4c263c1feaa'
         'd1972be7d506cf9dcfd75a4246613db9'
         'a14bf0f909600870b582a3b73a949441'
         '426ed53247237cf7c5e273cc689fcaca'
         'f4063259c85d7cbebea5e999ed265220'
         '46cd6d57a329f491a9627fb8e0d343f4'
         '8c09eef8588cb9a529363c62658fbf49'
         'c13d65d606d14341fddc88bfd2413a4d'
         '93ccdf72a16117aebcc062877ed040d7')
noextract=("${source[@]##*/}")

prepare() {
    cd "${srcdir}"
    7z x -y -bd "FirefoxSetup.exe"
    for f in "core"/*
    do
        n=$(echo "${f}" | tr 'A-Z' 'a-z')
        if test "${f}" != "${n}"
        then
            mv "${f}" "${n}"
        fi
    done
    sed -i '/MSVC[RP]100.dll/d' "core/dependentlibs.list"
}

package() {
    mkdir -p "${pkgdir}/apps${_apparch}/${_realname}"
    cp -R "${srcdir}/core"/* "${pkgdir}/apps${_apparch}/${_realname}/"
    rm "${pkgdir}/apps${_apparch}/${_realname}/browser/searchplugins"/*
    rm "${pkgdir}/apps${_apparch}/${_realname}"/{msvcp100.dll,msvcr100.dll}
    rm "${pkgdir}/apps${_apparch}/${_realname}"/maintenanceservice{.exe,_installer.exe}
    for f in "${srcdir}"/*.xpi
    do
        lang="${f##*/}"
        lang="${lang%%.xpi}"
        cp "${srcdir}/${lang}.xpi" "${pkgdir}/apps${_apparch}/${_realname}/browser/extensions/langpack-${lang}@firefox.mozilla.org.xpi"
    done
}
