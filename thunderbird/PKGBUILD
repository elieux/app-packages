# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=thunderbird
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=45.1.1
pkgrel=1
pkgdesc="Standalone, easy to customize mail/news reader"
url="http://www.mozilla.org/thunderbird/"
arch=('any')
license=('GPL' 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip)
source=("ThunderbirdSetup.exe::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Thunderbird%20Setup%20${pkgver}.exe"
        "ar.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "ast.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "be.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "br.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "ca.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "es-AR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-ES.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "et.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "he.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "ko.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lt.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "nb-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "pa-IN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "sq.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta-LK.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta-LK.xpi"
        "tr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "zh-CN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
sha512sums=('38949722fde60fe096fedea9b4583fc8dbf80caf927d427f12318a183c393ed9ed629589ac498937b96fefac574b5be700df322672f8ef759a9f4d283d88b709'
            '930fd2cb4b4c0da7179fea5b444a57dd0fd6ccd4c2484c0275a8fbd236dfcb37ecd138b1336e3395c3c9d0fe819d44ff6546acf168d6d3c56a30b68a5c613a69'
            '24ff1f95835c29a093e373169d9714f428d7f0ec8127f30b74639d6303115490ba0c4d0dfeee5636610f8e0d6bfef9e60a6d831782c613674d6a87856f01c20c'
            'ed303d831562bfaecd77c42570c20b37ee821287e467e9dcc7b54ebaa6c9744320bfe9fc2bbfa2898abf9970ebe2ef04b3ab3b6837f928ab2986bec4469833d7'
            '7ed1e644005720e81ab9ff7b4620eb890ddebc3dde90e398a066d9141c70b7e7fe5887a60e691a8c889cb49f35693b329ccb6fd3f825b250e6d2cacc51ba8836'
            '2704b371d1b8dc4ca94ffc3820192dd16390aec92f754c67e928668b165365291161e37115707a36236a6f371daa8fc06bcf03075936e650e98b99da796e1c30'
            '39d3fd32c128a6025780b800d86c9ed94e3c7f7805afc9dd72536bf55f17ec518ceb5a87a78f5274830a2b94f16a7fd2fefdf1a5385e12458de7f3ab4e8b16c2'
            '4812f39ea499c34374997333ef556bb6ac0fc0c23e5514e7af08881ed2592ddbf3bc3b0079e830b3c81d9eb42aeef5041c214adf60fa6a84f3f7eabc0af31494'
            'fd3637a985322a7afeed26a55aa8898b994cda2d835c71fa97444e8219cf31639966e668d5ad60c963919407629c852099a07b80c2e02c4b83dd7a69854cda62'
            '3b7bf86bd0098e6a39ea861a86b31ed3dd44aa9fb0ca9765bf253fe2941f47661a8024e112b31e687a81ac8bab164c771bff740aa9c0b9eb4e7c556d8dcd8638'
            '7f9e2a4c79f7361e933aeab5f4cb6c6126a37a8c6269af16f268766a7523e9bf2ece4234ae7f0371bffce99c6094a0dd091c0230c983964d445c86ebfa68f1a9'
            '064a96f1ca6af2a0fec87748f4bdc5f774127ea744971f26810e30fd4e818a84d44ea5be0d489871b34da1460b9abd83f9a76444dd975f7dec575c198d416a57'
            'cbd46d704203c8eef764dcad3766a94aa1d737af1f728c98b16e6266cd3f15aef90989df2d0691e4c0547b623409575390b2b29e48a740c823a9e2d3c03c9098'
            '71ea229ce102ffc38765bb6e112ddbf1eae1e45cae229751a52813079e1fa487ee30741b817f48d982a62ff9c6e5efaea5014adb915d5e3c3828cb7bcfc811fa'
            '73d6ab2a8d9c3e5c97ea9e4a6b2911bc10e0abcb90259439f988ec601995c63b54cdd42f5a41d74470c0871056a5ffd6f2d7e421bf21a51b25cd6093be38c949'
            '5e3b34258f0bea6ebacbb497810fb999f8d8d7b591aa2a2443eb674b5b98bc1511c15610863803307da5d476215cd2f9c7b1786ead7ae7e5c60f9baeebf53826'
            '2321c609911b838376b95c8763b21238ff5debeff9958d6e2f2212471f5d717e8654eeafb63f33d7cdaa361aa69a552adc10a439b5edc296ba7327f1de9b5852'
            'c2d3293b73e88a94fa2eeb306f55133ccb5ebe6d78f534e0d5be00e648c34cba81545ff2ac47fa9060fe173cece24b81bc2fea7706fd451d91f07e111aa6c422'
            '9ca7d1935edec474e27f6d6f9276c75cfbf35fb57a6a58ed340613655832cf54411d125b6f127c13407fc1ab498b5577e6ecc64f30b1c774b5943c4941efa08d'
            '46692480324a02bab3960214745f88071b31e9b3f85e8357ed520037980754303032c1e10f116d5cc073d118f67749bcf5485789e23f8f8b827493daed6a179d'
            'f1467aeae3f7f4b6153bcb670f5fc950ffd956e1da5b3c1e554e66904112792fc816016ced3f76e67a2855e02c1d4bb7ceca2da251d70a428c307666c7bf529c'
            '528d9ea09262cdc82ec10771ed99ec66cd2292fcd6b6c32817a9f045cda97e1e65e30fdf5e8fd893c93fba4cc8433ed92da7d11cab29c92a2558247c450becc3'
            'd761a4957ce09ffac7b5ac88a0dd875d29895c90d6836e70fe705113c60bf34a0d3e79d2829bc899289b8fc39cf397caf73f4ec54c4cb3a48166a237b5941af9'
            'e2a1f07edd2ac386998178124f6429a9215a06aa9b2bd6aa6ce76271de7a79cfe8200b68d281391441ea3987ea5781d239b7913750ba4860b92df84eccd2b992'
            '794d5826cf7ed4f1e4ed052867bc0600a5c8419a3e2e1bf10904f356f2d304f4bd9a8bd26b479180e84bea07b832c5eb610eee488f4c8ec3f6c95b811b066cdc'
            '4fcc335d109804bd0eb74098945ede22b32486a21c1fe226186bbb7cb96e5bc0ee179a388ca431b54e43beb3c7eab57913e6b243795d7b25557fecb31f2f1abf'
            '23dd0810fb5ebf9ecc2efeea2483fffb5396bea4a86ac7be6bd137965601b3992ca966700e6ff7159688031f1360dbf4240534bfc3b925e7c724cc904292a661'
            'a3e116ccb59a84009a4295abe7251d082eed4f55e53a85986fac6961493ee26a2c4768513187bedc7e95526197d6733a827d191f90d113bbed16c2d1cfbcac9e'
            'b5c021d66515fe8f13a97588953b47eba426e1f1bc7ca2afe45bc608a22db3ecfc5b06695fe441cd91a91b4bf3eb1b597c11c0dd98583a68f984dc570201c91d'
            '4c2d15c8ea44d8fb8c28afb3ce99b36c2ce0d4a211369fa34467d73205188dae7222b9ceb3db58ac5f9c38b7a7b3b6180d6b6175d81af20f9a1816e556fce393'
            '782be2f22cf1aa8cb7f1494ae3afc642f8c8e73b2e2507a32f13c4c764d356429e2e2c96f0891cde1c577f102a0fc8b365ab1e032ab03151570ec30b97f0a706'
            '416599c3f4a63ce6753c5e0d12077cf4b151cd97e5a53e78829799614dd8377284f06d7937ef6df1b55b7fafe1b22fc1ee32156a03e0fb30c00a51c04324b21b'
            '43faae5f11a788ac9e4e23d3cddfeaca5e146887deee4c4975f58ab2a7916b86e654b4727dbd4f25db2ef52b6f04e9d281f34c376716ef296359cbcb50b2066d'
            '431122f268b57c6cc3a8632b744899ade0b29e1d79a35f55d8e4c2920294aa7d13c402df0d66b98f85fb77d9994ab9d6dbd5c9ca48b85fd620595e454df35328'
            'd4d805dec4220547786481289b48ef99b7af0ea2b274b7fe8ad62c194497eb0f80d52889259649f2bad772431a919f59e63e33d8a06f7231864efe814969c4eb'
            '764fc6b482183c3b560f30db1f3e70bdadf52f53c9ca9eaf996084eaae44ec4d3aa81d06f1703ad86f24c7482f0d156478e218bd7b7aacb707afb3b1d2a819f9'
            '8fff46f29a76d1155406fe4c42dc48afa441efd4bcc16ab991cc37545fe589abb5d327836e06bb39b5886a4e92eba98fe525afde17baf79863da4309ce972795'
            '34460b61361ab71285041cd53848fa070dc3a5e2dbfd7289d753ea6fdc9452a20c2f3121568861c79adaf995b7ead0a4c2d0fe1c4ce60f99673bf2e0e18a7dff'
            'e70f684e24bb61e3a8071d46f1ddd6d70eda004c6e48b1a47a138846fdfc0ae947ab8ee516240c7c782b90cba0133bb8f74703e81027c04f8b2a4ed88b843905'
            'cfc24e1ce3ba053cabbf4ad1a4693a879b206307134d463cf6ed732c862e696929d5f72317517abc5fd48145a5b8dcfa700b1919dc1d904d3e1030b4f8834ae4'
            '8338257e1b2311bc817b68b397cb13e2181c361e71aa31d475024fdaf10375e0d91b53854b1d0ffc392f02083032b4d09f2b0118117409cb1c931fc2c70e94eb'
            'a62cf07a7930fbc46387aba20f60d3cddbcc1927737fabf5e45093c57693e42909513ebc839501fdb08962f946995800eb98e4876ce5730f34f6682facf6d642'
            '324157a1ed933d442b177bd06e1511689774da31faa35e6aa4e4a8a6e1a04d502cae19fe2cc58e3a7cf7511e62dd6a3468a3b7cd7c8ecb5ae1fa94498a4af457'
            'ab65844cb21325622f471afcf455b32164be5bab14c4ff7091d1c39e8bbe9447dc59a504c98454b44d194fd535173acd3a8aec03a451b49a8ddca7f6476aa276'
            '5a3f1a13fe7f92e3a0ffca3f8b31353466384ed3cbf77a1f5056a806ac912f6906454e16a3ebbf9eafbd8759196659e8025ef55338ea68da0dc344e220b0fbe5'
            'a7a0d054f15c63bf305fc265a5a055cb706ad5a53b3017f9f5728e343a666110462cb357324d61f5daa6feca43a652eb6a74bf09e32053430c52a4b5a211899b'
            'c16b66d7d829a93c2ce14439af05d90ed4590c1412fba128773c615b386791cfdedc74821287d4d3e4960a1876517db190891b090820a3005ea8163ecac3c22f'
            'd39d8c5456d1698414b4124518069b3d077ff118de890153339a147ff0d6635e747244175ae5397565585cc46452cf6631b3fa952ce2ce787b55cf47b0cda9f2'
            'bc9471585c8ee3b20b861b931f8798f0ff7172a017286d6e4e641f8c1dee814044670079528d0c0126622c93716d663dba728b20496845b3c22d395e5af763ab'
            '7ab475ec89e0f4020feacd774629c70d7f6addb1952c7e00ffe28c85719a1e0cb15bc111022be0ae28425eae7be604e8f764eac9527ade4bdf6adde385c2198b'
            'f6e61b03e204f0a3076567d698c421554d85ea8e37f5e6a223eb0c9d9650e4497cc8c92cd8a60a6b1b9eb5db2d17440e37acf29b1eba3ea8d74891230e09dcef'
            '91b4a4985d80925a508e7c4b1bbbc5e1e5936ae13210e87ac123ec0b2f83c8e0f658d063776d734934dcc5a7e0250ec2fbf652ed32d4fab033eabc32393efd47'
            '96fffa67c6d83b26d64564f4db5fd4c1f8682cbdd60241094a1beea7a09e3bcc7116bf754ab4571a58fa499746d71cfecc6cfae1bb7eb09fc1ed9ed282de007b'
            '07a19ef50f08b9aec6aefaf18abfab386cdeb2b99e6c0dfa5c880370862575b43fdf7d82780476fe77fc40f3ca1d9c0fb72fe1ec637ff790594e708cf014c47e'
            '2900e6a3e1e03301723d51bf7984f1243662aa43df4489654075695fca7faa193337c232f457e40a8114e972112a7872c162d98d64fa7489d2008d362f80a840'
            '051931a439fbe924464d7ba9b5ebf8c27ded23bab9c22ca061da3f31ee22998823be4297a812e1b7c23e80250733446ef2de70434b599bd0bac953686f621cee'
            '19a70e1a98e9a5d1370d53a9e2f2a9a56281af934387619a17030763692de1ffae1649e923ee8e8c6d180445e0031498b79a80c4e9ec431f054d2e97e28d5689'
            'd78d0c3cbac33f9e1f47d622bf4d06b440b4c3dca0684df2beb197b0922647f62f70421a04e5a3b98dd3da166e304c0ed9386e9a2aff03e61af3b3e81b2c439a'
            '06f6f8923efb7eb8fc83c990cf75763e15f7e846ac390eb162f92303168e1bdfbeafc0386b9affa7d8873e0ee400ead89429515b09d108c55c8697b9df57e15b')
noextract=("${source[@]%%::*}")

_lc() {
    for f in "${@}"
    do
        n="$(echo "${f}" | tr 'A-Z' 'a-z')"
        if test "${f}" != "${n}"
        then
            mv "${f}" "${n}"
        fi
    done
}

prepare() {
    7z x -y -bd "ThunderbirdSetup.exe"
    _lc "core"/*
    sed -i '/MSVC[RP]120.dll/d' "core/dependentlibs.list"
}

package() {
    a="${pkgdir}/apps${_apparch}/${_realname}"
    mkdir -p "${a}"
    cp -r "core"/* "${a}"
    rm "${a}"/msvc{p,r}120.dll "${a}"/maintenanceservice{.exe,_installer.exe}
    for f in *.xpi
    do
        f="${f##*/}"
        f="${f%%.xpi}"
        cp "${f}.xpi" "${a}/extensions/langpack-${f}@thunderbird.mozilla.org.xpi"
    done
}
