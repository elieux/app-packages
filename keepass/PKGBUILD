# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=keepass
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=2.29
pkgrel=2
pkgdesc="Light-weight and easy-to-use password manager"
url="http://keepass.info/"
arch=('any')
license=('GPL2')
makedepends=("unzip")
provides=("${pkgbase}")
options=(!strip)
source=("KeePass2.zip::http://downloads.sourceforge.net/${_realname}/KeePass%202.x/${pkgver}/KeePass-${pkgver}.zip"
        "KeePass2-TrlUtil.zip::http://keepass.info/download/v2_trlutil/TrlUtil-${pkgver}.zip"
        "KPScript.zip::http://keepass.info/extensions/v2/kpscript/KPScript-${pkgver}.zip"
        "KeePass.config.xml"

        # translations
        "KeePass2-Bulgarian.zip::http://downloads.sourceforge.net/keepass/Bulgarian-2.10.zip"
        "KeePass2-Burmese.zip::http://downloads.sourceforge.net/keepass/Burmese-2.19.zip"
        "KeePass2-Chinese_Simplified.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Chinese_Simplified.zip"
        "KeePass2-Chinese_Traditional.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Chinese_Traditional.zip"
        "KeePass2-Croatian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Croatian.zip"
        "KeePass2-Czech.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Czech.zip"
        "KeePass2-Danish.zip::http://downloads.sourceforge.net/keepass/KeePass-2.28-Danish.zip"
        "KeePass2-Dutch.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Dutch.zip"
        "KeePass2-Finnish.zip::http://downloads.sourceforge.net/keepass/Finnish-2.18.zip"
        "KeePass2-French.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-French.zip"
        "KeePass2-German.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-German.zip"
        "KeePass2-Greek.zip::http://downloads.sourceforge.net/keepass/KeePass-2.21-Greek.zip"
        "KeePass2-Hungarian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Hungarian.zip"
        "KeePass2-Indonesian.zip::http://downloads.sourceforge.net/keepass/KeePass-2.23-Indonesian.zip"
        "KeePass2-Italian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Italian.zip"
        "KeePass2-Japanese.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Japanese.zip"
        "KeePass2-Korean.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Korean.zip"
        "KeePass2-Latin.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Latin.zip"
        "KeePass2-Lithuanian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Lithuanian.zip"
        "KeePass2-Norwegian_NB.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Norwegian_NB.zip"
        "KeePass2-Pashto.zip::http://downloads.sourceforge.net/keepass/KeePass-2.28-Pashto.zip"
        "KeePass2-Persian.zip::http://downloads.sourceforge.net/keepass/Persian-2.08.zip"
        "KeePass2-Polish.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Polish.zip"
        "KeePass2-Portuguese_BR.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Portuguese_BR.zip"
        "KeePass2-Portuguese_PT.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Portuguese_PT.zip"
        "KeePass2-Romanian.zip::http://downloads.sourceforge.net/keepass/KeePass-2.22-Romanian.zip"
        "KeePass2-Russian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Russian.zip"
        "KeePass2-Serbian.zip::http://downloads.sourceforge.net/keepass/KeePass-2.23-Serbian.zip"
        "KeePass2-Slovak.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Slovak.zip"
        "KeePass2-Slovenian.zip::http://downloads.sourceforge.net/keepass/Slovenian-2.07.zip"
        "KeePass2-Spanish.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Spanish.zip"
        "KeePass2-Swedish.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Swedish.zip"
        "KeePass2-Turkish.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Turkish.zip"
        "KeePass2-Ukrainian.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Ukrainian.zip"
        "KeePass2-Vietnamese.zip::http://downloads.sourceforge.net/keepass/KeePass-${pkgver}-Vietnamese.zip"
)
md5sums=('edf6ddc24346a6181a898e78db1d352c'
         'f6560428e3ffc61e4b45e0a5645687c9'
         '7040f42231abd12caf6c9477086fcc89'
         'ac0f1e104f82d295c27646bfff39fecc'
         '26138bb070035de02e04f62ae592e1f3'
         '1d0672b626bc7ba577c5ef40471c6884'
         '1f47e717ff9050da257b4dad5b37af7c'
         '2582995864c36f682adb30c01ee1eb16'
         '77495b8b2dffcd733809e92ff7340bd6'
         'e1d3c755d89d301feaf1b881257e038b'
         'c2c0d91a19c859793b679e72f3e78c33'
         '4b265474594eac0d3313d79049621a11'
         'dc284751a01eb3e12e7d100e96deed7b'
         '43204029213dee42d2ef82b2332ac5fe'
         '25f7f46997ce7a12c34377c9f8d9b561'
         'b4129b1d4c37fa33d3804a17a7576fad'
         '2a9342924657100e9f53455c61c6cf7e'
         '5de5de415f5d4948a2f132301e49e1a2'
         '5ef106224576d823f3636ed633f10bc3'
         'eec07f9354c47560041b4c93ff218a1d'
         '5d4eb43bce00f3efe5cb4181c0f44f27'
         '8b0a0d045f368a1f09bd452dd7df72b5'
         '18796d380af78202e8af827f0c113864'
         '5d7c39922bb9a612dabad000344b8200'
         '2f0b83f5eac695787bd9785e86ea4ed7'
         '3172ba110fd730ca4c894f9e52f09930'
         'b5fd7de0bb2b3a833b81cda6f28ff1eb'
         '190f87db4ae56c9ee6f67973da90495a'
         '8e18f8ed9ce53c7c8d3326deeda67be9'
         '1d14dda46ccb4f6c921055a58080f0fe'
         'd918572cc34ea670c8386b4fb972d64a'
         'e4b2091d66e182811d3af9bf6d189f31'
         '8b0ac2bd9364dd22a94c03e7711da718'
         'fc2424e22acea3f423dd8b9667bea582'
         'a04c41a2bcb2f3026235f0f2d73dfed2'
         'ec7dafeba161f56221afcf24b7cb13cd'
         '55613d74738f1f694e6ede542e4b49fa'
         '3dc3f16a897100e782beabaa33182b3d'
         'c96ba09d4508939be336744d2e9751c6')
noextract=("KeePass2-TrlUtil.zip")

prepare() {
    unzip -o "KeePass2-TrlUtil.zip" -d "TrlUtil"
    # when KPScript.exe is lowercased, it fails to load, so let's just keep everything as is
}

package() {
    a="${pkgdir}/apps${_apparch}/${_realname}"
    mkdir -p "${a}"
    cp -r *.{exe,exe.config,dll,lngx} "KeePass.config.xml" "TrlUtil" "XSL" "${a}"
    cp "KeePass.config.xml" "${a}/TrlUtil"

    d="${pkgdir}/docs${_apparch}/${_realname}"
    mkdir -p "${d}"
    cp *.{chm,txt} "${d}"
}
