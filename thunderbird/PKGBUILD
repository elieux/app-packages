# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=thunderbird
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=45.2.0
pkgrel=1
pkgdesc="Standalone, easy to customize mail/news reader"
url="http://www.mozilla.org/thunderbird/"
arch=('any')
license=('GPL' 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip)
source=("ThunderbirdSetup.exe::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Thunderbird%20Setup%20${pkgver}.exe"
        "ar.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "ast.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "be.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "br.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "ca.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "es-AR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-ES.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "et.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "he.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "ko.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lt.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "nb-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "pa-IN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "sq.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta-LK.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta-LK.xpi"
        "tr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "zh-CN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
sha512sums=('5726384e92ec16dbdc8681e2a7924296592e84fc8c50639605fc3c055da5708b226734abd28c288454f130016ffdd65f0af2dc4dd9b73d6d5211ba28d4ec38f4'
            '4e6d3417c0f3752decbbe46e975a1af57d4d91c6ab974f18853ba14d1db9caba390f581c4625aad7b2161949194b341e46b9de11d258ee3f21e0526f99cb3f75'
            'b64cb53da422954b47fc59bf35778fbffb111f1fbd8f910505a135c2ee2d39986c7bd39906b708a936cd31466b9d6500cbd11d169eeec4203aef2f066d5f36eb'
            '6b60e39c7368d7e58fe737f9e6e1e3177412aa8878b1eb95f031b7e2d033f53ddf28ff98f103e1bb674d5495de8cfb7d7c90a381d85f413dc314843730fd3392'
            '7466c11291eac08c9add5759eac80ada7b72d403cb3356e8bb2f92bac92f4e4fac2778bdbb6babe65283372f3aba11b34167738dd910c356175c0ce8ac97c3e4'
            '6193c3723f30e7a70a33c317250187549c7130b3647ca4d7abc0b3f14465aeb16eac267e381a9a17351577887ba2f5b2ae97a12a8977ba1eb919ccc1cb613620'
            '51ecb1fdfa8ab86df62e3acb142326c731490bf1b95720eb1e8ccd9cc0595a9a5aed8adfa10b7d7ace8702c60e71aefbc84423679bf0bca90f23787bae5d70ec'
            '3a48a14740eb8c38363fa6bb8a2625daaf340b525879e29b6066092bdd8da202d17e9aca1168b5b93243243ff7caaf3af8d3a4878e81e81f7c19d0c6376fa9c7'
            'd9a475a3582e0b09a47b9b704a44eff98832a337590428684b6a7a53dbc66e7b3631f31773487256d9e53059d7e32fcc69f6350ba676f3422fb42fb402a01707'
            'a5a77a28a95147b6b29a26832b07f43543a870ef9e9aa7a5df8c6dbce1b783e5c9c553c80a58a36c788d4f069bd5707f89d2c5040db6255f0459bfa03b541a2a'
            'af0c634fa80d5d9fb9468557bc08355d6ac014b98622af01909ddd404bcf9469414caaee80cd141b78020cc4a08fa4eb898b344e159b9fb4badfc34b2e7a7bef'
            'ef92b883c6d81e1a0e4688cdaeb51c9f069936d7a49b8a96ce1c17fb57ad6c223aee94e51eb4a36231c1175eecc39ab0e1928f01e32699911970f8b82e000d7c'
            '8b4e244c05642eff261164c51442bee900ac69265509488eb013c7c2f45e6f2e5cf45271464b1c782dc27bc19dc6f633016eeb4816f0eea4f3bbec7086f43f34'
            '9acfe0b321b1dface155a5d1c8dfc1c607ccf9c8b1099a00a334849d3f7f10fe7fa43f3493df2937228b9dd96e531cbdd63dd29f04b880fb486c83a10919910e'
            'ffc05ab9358eaea2b2900816deec5c28f6c0e3ce4307793a543026aa05ea81df99ac898495d6febcc6ba28d1ba834c62689cf779f7aeda7e87067dbd21c12a1b'
            '72311815fa13432bbb9c2aedca85f19e830efc07edc948d7bcd8e1ddf326d701c218855d62fc35dc2694f6e284b608089085dd18006fcf5d295f480bb1667b39'
            'eabc915019072e197f38e0f24fea60acf06ad7259133979073b9f39be3a192c2c6cf89ff1258bd505aeeb1dfd07899dc6c19e80c4646d6feb79f80027360405e'
            '917be79246ee9628af5ce0087ef4bb5c27b4a6aa8819187cee64f0dfea952a719201e71d2d809654535ffa9f20bbf3ef07817ef5bf06c4a258509c3fcf830d90'
            '40a95155181a802faa6e5f437c98bd147f5eba280b9a5fcd4ec89ed9e4df2e10ccb1bd47697b3fe9c0b342d6feb5fd77cfdf400ddb436c5582c09c6e4af3d08d'
            '460aaea9565412e19db8abfcbc391f485b22272854ee4a1b0c1e23b45dc47e60dcea3305958e2472e559dc869ec535c04fe30b3044467f30903837812d2cfccf'
            '785fa087b7bd37628d8306b20690ff94e46b18bbd195c292b6f16fcb61214f849037aa21df01cafd4dddfa6ac19e237c1f9ee58eb5f6a11d8461356268e1f8ff'
            'eb3d171fbc7573c383f5cd60acba389b04490f8b26a9452fadb20a224edcd6165e053ef841bc957701fc2a4d60df5350f8d52e43fb748db8d8ebaf8a294aecd1'
            '4b317bc2b5d520ff624bac047fd8273b0c4845cc79335c0ef51d9cedcb2bbbb481f250b4b7289d0f231f0459eedcaafc29615d96427e3e48b803e7b3d19a5ee0'
            '3f2d5302dd4841f03164eb573289c63773a30b330d4bacab7de28abe0b29b76b1bcae27edfc00ff3de2dad07f0e01eb720c665eda0591a31db95880db476b3af'
            '123e28d41cc18494c9122952bcd04c82ad11f4c05bdc9e8d2d529e374e7d311e383837608121cbb6a209eaa23f41639c42758e5692dfc84104f42376b9a30dd1'
            '0acb2988457f798f3682534d3a1647c16a5ae0e9cfd89ece144a3c1aa9342fc7b81cfbd661f1591d6df88463aff5ac4c3d75b5dee868e4e2c3475210508ec294'
            '09b968e6b0562593eb92d38d7a396d7c3c20f3fa460681f12d9df5d0bf16194284250be263af922d938a1aff6a46192930e44ae216d04b5e2107f96b113b7bcb'
            '6668adb9d8270963b5ac422907ce0a53b15ca891f32e8f8de80d4351c761d398c162c0bc217f05691037d125cccec3513eeb8dd3237a979439c22d3d42634ce9'
            'bfc46308dff23d76f34675a095c17e645f079b6b5b2d202714a1eff318c6e5d72e47d48814dfd6f67fee3b5e2cfa3348ca2fb56a9afc1c4c131618ee3d87eef6'
            '33d0b91dfea47abad9d414a17781efbbfd79dfc90947a4096fc8dae4aaa0cdbc814b806ac767f0298383a909f70e5f6b763cb3fac03db93b7cab99bfe350b765'
            '24bb1db55530614928b5007873019b88977f2fac26553d5603cc70cf4b17ce50d81b83fe4bc602792c21038248797f6d71d646659aa1a37169000c3701bab49b'
            '7671f4fa01db6900403545ec6ca7fef3c8982982e0c721015c716b4a4b61ce4811c5ec9c6f9168cf3c606d675dbe0016add6078d44ed3a483e54337dbfd9fbc8'
            'd8d532a40701a234d7d68d2b2e183c9791966a708e13d71e12616733b4590c246998a9cf93cf2af3185b95d886834d658cd1ec874a12f2341f72cf6a6ebbfe91'
            '4e25346d7f2f58bab0512803bba915b919e19c85228d3e80ed93b7608bdf17b470497619feaaf786825994bd9561dbf38a9c5d2e3ac2cb3bd529e5d700085b71'
            'e9d2fbfbfbfa7220fb94e706e761ec9e3ab668dd34e0444328a65867534a14289534205b169c7de0aca358ab2ecf347faa262a10009a4b584bb98573f623fe48'
            '1db8cb08464b8cc5ec789af13b7c78579c8cb11dffbe6dcfa11a361e8d248b254aa0f5b46f005403326fab71206f1d05c6f4a7c81edff509ce4d577c9bbc4582'
            '04bed7a7095d7572efb1da2eb14e9b144d57594be0fb0de69bcd6b5fa7f682fd6ee3ce7c1e04262960896a94a9ae6bdb996d697d57383f55e36df938f4dd0b26'
            'a596594716b6f8ddc20c23c1d4c5b293486c85fb445060e2700dea6eebeb9716072609c32ff9e49a294b98fda46749643f47b262116d6a0cab17dd45d9c7f512'
            'f6a425a833302bf0c2e68b25c586f8e6b636a7cf940fe53544418f6a7216ab28f3e25eabded677f2c5cb51b6c86a7e00733087d40c961405c49b162ddd9da59f'
            '41cd2ba142356304b141d30b9cb0ab634dd638d5a6119d57e7e7315a759e365c4321f832148fab7b351a90d9ff8f83fcb400566f5bb2e06e69dbf5364886bdce'
            '227b6f1565993f199346635f24cf1cc245589d3fc334e17dcd2bee2378c9a94edcf016f4beb314c4f13f605376fbf81161cf28b0a67c7434277b175122559b72'
            'd5a09192849916eeb822cbf53b38abb65a3a28a7ae67d11a942e8372c4f81739ef70db4a0ebe54cd070211f0ebb0bf31f87957f351ae26f747142e21f39e091e'
            'd7d1276cda144dc463b62cd29daf893e30606b225632c2233a844fc57ddd23d695e311ddf2c5d5f432635e905a34215980f9d8338a2534bfea5e2e7f5ecc6958'
            'ee499ecbbb74aa99c55e112f3e11c6969259adaac35c9068bf14553cbc4742e228d52e276896bd2c3d809cbf1e7c72322b33e2ac247e878b8bca44e980a34f33'
            'd31be1bb7ce7e2a060f931241b7a45d349c05fd0d46161a5d0f7b12b816b4c90334a75cb87c34661282b31fe1bfb8c8e1548d63e267f2265ab2f08379c41aa49'
            '8f3290fba286acc72bc8d84b0040043bc69864a6965f28ba5dca6bde854cdb2c247577796af11fe442aeb02974b2ffe105ec22c38f824b0b4beddd4d7e9a54b5'
            '23da08e3a83af06be14229b954259f20600b59ce25468735b49f35de54e38e8682828728cada6a89aaa441d8c538a1ac844cfe07862cb0a8c6e9242c5b88de76'
            '9bcf08e759f905ae51b49f4b04598cba43a2c1aed00bc6d059488fc5b794a8bf1552b12960f62cefc7d726fd278c6e2957ebe39ed7e8244a0027266434d6a91f'
            'd98e0c914acf0728a65b19c9e8d30fbe17c17f60981b9e8dbdeca4cba40889d30ee6fe05c57547c76c052c3977ba08b4b21752a75a6261ed0d7a007dc3b6e787'
            '427ff39bd13adb2d3d1f7e461fa741d866cac9f6bac09819c124cd42d8783fc6857b726f62a1bab3e7fa01c0687363f72797edd955a48a47fbbf92a42af9c7da'
            'f0fe9b527b6e09bb42f4d65b23ec3e8f4a6a5fe70f4b9b991353382a11192e49b2a85b223762fdd7b04fde2cc57bb2891a36cbedf53227cd602a87b1fd0d8c0f'
            'e03bfa58f7d37cb142327a7bfa116964300397107d710ddb4efc1e96e904bf058f31fa9aa0e759759bb7c522ae358eed30adf42ad8c256e345d9059c9d94ae61'
            '59a3ca6f81125ccef90110aed3637c16983539ce85219cade0b86a422b7e47b25a63df524ba80515a9e0f93274a2dd658b49ccd63932e490394c926a07e99ae7'
            'c03b34c104893e3233710f69edf0603318e097ef2ac0803572b0436544586618bbae20fe0a87d4062c12f855f567c294c650202b677b6de663f414cf3e1f4845'
            'efe67d239a83efbb79d81965b84354ec1e4b9e02854af0047e8566f7e4a91773d5e78bd124875b223a3cbdc8a6ebb052c1513602a87b3d18b6dd4f9484562a1a'
            '63d5f29ec4c737ce047f1f4f0cc355dbd7d968940ed78967e2919bcf78de00bf3eb177c19a23bd32e33bb43e77edd85aac1af36694a28452172d00f3ad6921ea'
            'fc86a61ea9e1a2cc26a75a0caa4773855c098587bb0189bf6cde4e36993753c27dc92e26c757a1746fb26efde5ba93357b6eff99f2d6704b21d741868d255709'
            'd236902598d113530732b7029e6f86eb4725a23f2f7cd67bf870d05a915e50159d8a25732a991a61d4e047391b44c0ef8093d9b99795eaff006ce5c6b3608af2'
            '8ca5aba4e27294b838491ad6f7ed268d1a8d71a8f586d784313d68f9e7a2a02cf4507c78505209f2be76f7fc86b52d617dadb549c89b206db0ea1d166a149b7a')
noextract=("${source[@]%%::*}")

_lc() {
    for f in "${@}"
    do
        n="$(echo "${f}" | tr 'A-Z' 'a-z')"
        if test "${f}" != "${n}"
        then
            mv "${f}" "${n}"
        fi
    done
}

prepare() {
    7z x -y -bd "ThunderbirdSetup.exe"
    _lc "core"/*
    sed -i '/MSVC[RP]120.dll/d' "core/dependentlibs.list"
}

package() {
    a="${pkgdir}/apps${_apparch}/${_realname}"
    mkdir -p "${a}"
    cp -r "core"/* "${a}"
    rm "${a}"/msvc{p,r}120.dll "${a}"/maintenanceservice{.exe,_installer.exe}
    for f in *.xpi
    do
        f="${f##*/}"
        f="${f%%.xpi}"
        cp "${f}.xpi" "${a}/extensions/langpack-${f}@thunderbird.mozilla.org.xpi"
    done
}
