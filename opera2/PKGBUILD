# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=opera2
_apparch=32
pkgname=("app-i686-${_realname}")
pkgver=26.0.1656.60
pkgrel=1
pkgdesc="A fast and free Blink-based web browser"
url="http://www.opera.com/computer"
arch=('any')
license=('custom')
makedepends=("p7zip")
options=(!strip) # digital signatures
source=("Opera_Setup.exe::http://www.opera.com/download/get/?id=37854&location=395&nothanks=yes&sub=marine")
md5sums=('11420a2a99b639f8bb83f2f7bbb29e36')

prepare() {
    cd "${srcdir}"
    7z x -ry "Opera_Setup.exe" > /dev/null
}

build() {
    cd "${srcdir}"
    # Opera_Setup.exe -silent -installfolder="${srcdir}/exe${_apparch}" -allusers=0 -copyonly=1 -setdefaultbrowser=0 -desktopshortcut=0 -startmenushortcut=0 -pintotaskbar=0 -launchopera=0
    true
}

package() {
    mkdir -p "${pkgdir}/apps${_apparch}/${_realname}"
    cp -R * "${pkgdir}/apps${_apparch}/${_realname}"
    rm -r "${pkgdir}/apps${_apparch}"/${_realname}/{Assets,root_files_list,files_list,launcher.exe,launcher.visualelementsmanifest.xml,opera.dll,Opera_Setup.exe,Resources.pri}
    rm -r "${pkgdir}/apps${_apparch}"/${_realname}/{msvcp100.dll,msvcr100.dll}
    rm -r "${pkgdir}/apps${_apparch}"/${_realname}/{installer.exe,opera_autoupdate.exe,opera_autoupdate.licenses,opera_autoupdate.version}
}
