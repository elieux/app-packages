# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=thunderbird
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=45.3.0
pkgrel=1
pkgdesc="Standalone, easy to customize mail/news reader"
url="http://www.mozilla.org/thunderbird/"
arch=('any')
license=('GPL' 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip)
source=("ThunderbirdSetup.exe::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Thunderbird%20Setup%20${pkgver}.exe"
        "ar.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "ast.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "be.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "br.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "ca.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "es-AR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-ES.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "et.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "he.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "ko.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lt.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "nb-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "pa-IN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "sq.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta-LK.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta-LK.xpi"
        "tr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "zh-CN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
sha512sums=('817b8c9f98617ea1e77b2034d97e631bb77f98a9f8626f96f1637d3f554b7a8f553eee67eaa0484ab1825903d564192cdfe20b9be4224fe72fd51289b5de16fe'
            'd5eb87d8d06188c591915c90252058df49a69e7d7ff19c8ca7bbd13c6e42126723d696021b894606fb1d5cf473aba0fe014576054c1160d81a2027c8a6d80396'
            '65bc98573999cb614489afff4f29ca0f281fb9d10bc25005e98307e9d163932dfd49ba01230cfb865d5d9b5fe6c1c069dd7b538c974b60e2b1009299014eeff5'
            'ad7f7ac5247d318f323f5e63c0a3fe873e1b6e5800f1b111234d9238780fd80a6acecbb3a8de345874a7449b5e1e41b14f39e1a35435b7e08edf241d4ef60d68'
            '0ac651a3676f545111bc28df36b72e8ec6388a25c1eee6d2993327970a410c25af3b81d870d97b1ce295103386ad9a0a3d8950105ab536dd11ef3780d11e1b0d'
            '762f1d86a86c3d888c4cbaec63586c0e0c7b4c6d8e98552398bf04514b9d9142e0d65df9e2f8f16bfb421a616ebff9328bfe31b0c22c638e7493944e2ee2ce0a'
            '313f1c574d25d5671822dc5b4a8d13d963a7053ef946a1ae532b2f8d707d0fbf7058906c2d008fbf1a5e24fff518375fd153bdcca63bccf7776cbc90c168a385'
            '0c86aa852bc2cbd3d69fdf37e9f51a566b86b360bb4611a1db0103591fd6f0822143c236e921acd1d846d669741b70761f97529d08deae43f2a562a1cd536d58'
            '84a19bd8040225a25d84352e7d032376fd8266fe2edc1aec31a37f574f624f619501339411a2dda41e687d80889a02e73bc48ca8270374f72d1ec1cc1957f00d'
            'f067007ed92bcd43beee909fb20a8971facd3a017b5430aa848f62364fc4d885005004d5e30d50c578b9e4cc23e470de14dd2bb17402349f41a322495d2c9986'
            '75918c5ed3f328e8cedc6f51969ffc97137f61e29e89e848de0c3cad63b23dc4ea8604a22dd86c27eb9a613c40b67ce5bd97ca29f1c96a3a11d79d7db7f6c45a'
            '81f7deb411222bdbb70c7b9b3e6c0909c2a5c814bf1ab8bf1127abc23372ad99c6c0b32ba5fbec66663adedf29d021275fa391f067fc903eea00e51bb8ed62f4'
            'bbfd4bf41b7816536b5d7082cd710f1b5f7da11288c8b55ba3d448e7f1d8b940d9ce38644aa5f185f885b62dbc23bda12ca3ec718399ae26e76416b4d5fef84e'
            'ce77f81f9f0103a350a46e750851bbbc8e69842458b8c6a2fbaf5d7d6bef5fb01905c2b82e393365d8100ef1e870eb8e2f09e7d5a8d5c002d0d6e2af8b4a6ef4'
            'a2bb456f8ebcc26c01343a92f9b728a177b0648a5e2817cc36aec7cac974838d9ba83a0291bd0b2042560a478e58344af2e3f0b9086e6eb7ec91b7790c839866'
            'b2c4b4c78bb9a12d5e9da03dd75977567a0a06806a2b20cde96453b4c72761b65a42195042f97e3781aa873cf08ec21a1c07f13d6f4dafe549b181add0d94caf'
            '2816588f13a44747acc74bce6a6b67e5060629e298a64dc33270fd96d2aec4b514b2bd4205c8ef846dbd5dc849dd99e0e0409a632a9ab0a4654b65be8605477e'
            '36d65d997c51f9cd9459342f11253c8c4b3017437fd9e3be49294e3ef1e3c1e188494638f17828080275011426856177c426018dbdb2d55d10da7f212c06928c'
            'cc735db814baeec6bc922be145545e05d656d42ebc80b926ae2bcbfc6700d34ba337b4bba54f3333127c215fe234f9bb6b7b3690468a49dd148e995ee8af126e'
            '57ad6bc0db14aa25cc6bc78ab49118509e9a625fb2423d36e5c255dd791cd3a6511b5256e16e4a34d8fd54d533f6b026fa821193c680688f37e5266c5fa5dcae'
            'bdd7900f7a866c0a4d762a85b593c0a6c2d3e2dab4a7e6b4e5ec2e91e86dbc8b88729bf8b58804c41f375a160646c3d4e3c29f5900cf15cdd1124f2b17ff276c'
            '61339691393b51b264fa06ed64d113daf9808f75ecb188b74408be33f25b68ed42f46d9d9cb6e972d82d260ca94125435dca7ffbd341defbee8f74b50b47d3f0'
            'dba9e70788f7b199a08cef6ee4fb91dadf9ff34955294f97fdc222cc2a68e6984d36a6c0d9cb4c5f361db5ac28347767dc4da3fc4ffef82e8daf00704a59a9ed'
            'a1469180b220bab9ee1dc64d41f9fb48c091f6c2972b1dfcfb955bd7a716f09f364ebbebbd92df2693c36a8e2363da5be250443367e58db91881cd559a39eb51'
            '638a4240a6646ba80328b93000de9ba20325493cc6173f9afb272a64fe9bf3de629e25b48eb9c42fe3aca746e37b9958e676c95048a1c96b5f38550955581dd4'
            '3bd570597bbd157f2c61feec155dbbd9cf46b92f3fbae3b070ae9f74bc7dc38055fdc16cd1a8dc56783224cb928c4b0c0518ca281d34e987bc02d917f4793bce'
            '436e2397c696900244342c4e6a59d9329bdea0fd9037fa4cd1cf0aad22df35f5749c4308bf934374e85db2426fb5253587d980b56fdc6bb010d3bc3fb4478ea6'
            '3fd0c4c33ed6f279728ad912c64c7d798869329f8902b934040e74bb1b4a958714921ab330349081b13ee6792292139dfe033d009e193dd1cada21ef95f1acb4'
            'e1837f9be44ca64ff5fbb43d2e1cfb48f29a428a370ac3ad426c5ce83af37c005bca06d4dbe154dbfb361fdc4de38b60134848c797ebf4bc25c296d15be4265a'
            '4455d0198314a691fa627c2f89c35f92276085e410fde8d0d07d76c0cef4197c27bd10f0a06c9acbc3712d517bff42ec479efa755ee251975191be7305a5ceaa'
            '7128fa1c5aee48c6204b5dd8d33206c84ef8b359d81634b6bbfbb3d928c799435208684de74baa35d8b3cc178cb4b1202d3305d5d895898774c2810bd85eb5e0'
            'f2d036a2d98df7e4774f3b8184b114acbcb769f9f15ccd82527fa6f2b100868d9ef4edff071e970ba9f56c5181a1c7df0e533d27d4de99a4e195783f1f3b04f8'
            'a275990168cc62690d4c6803202bd68d7dcc83c3e8669661426d8ef55bb5e67cfe9ab002e47b886482895d84253202a23fdf701cd08e7a60ffdb33b2a7d72995'
            '01f3938184bd77290eaa2019e44fbdcf02a8d0e2be48ee498862950164e17a195c690f7f48d88ac66e82e70ae3e146a0045ef74b8f37de681bd56842429c3321'
            'e2b6500204701d4e9e078a92675af2d95d318f8e468ab97583f6a256abf4c71bfa35b92af39dedf7e04988d31b7f5cc3eaa80e1a17f08017d7036ed3cb48b306'
            'a2626a4c35c66f0c2c59d0bed39b04b702858882bf178adcad1acc46630378589b8cc8d98eb74648179d55a3d202b80cedde7285d0e12336895919c023610617'
            'fe9b383f500bf1c41aa43bc2d2196305439067a9ae4803bafaa5d4e17e0218269ab89f74b4aa79f47d1ca4cc420efa992a0b69f1cae745a54109dfa3bdba7664'
            '63e06259f9d58b49fd12bd936954d2845100471a2a4ca981a143bd9dff500093b0324dcaef7ad71ba93abc177bde240b73a36f2ce94301fc042359de37d5a4fe'
            'adda7b35a2d42bf258402a49c1d14dbbd93e744303cc6322e3a1cf76252282b1240642976b05788ebdc468c3a3ec8388b57d876abd062072a164a8868600df0d'
            '30f99ebcd0d5115f0bcf9d44c4b1662eeb69df058e361e5ed2067acb2e1458cd90d984123e645f7576e2c2f0bb248cfd2e7176180b703b4df82a3ee719388a0d'
            '729434165d98a7711f0032e89cc39085bcc3b83f1542e379382a9253c5548f2f634841ff2e4a291f7c2cc8c642aca1d7089641a2e351a8d38588739868477273'
            'd370b930c849cec9e2d60849ce216b22e5494f52a941a7885429e3e688431d56dc30a8b401e9b3aa2b876cff794e16c6b973b5b4122c3d9f8f7372f3b2dcaad4'
            '44a9007b455d81af22ada6f491c9873d1e04dc6e455c6000cdf12a5426dca509d1993d05a8a75016d0e7e8085949208174c4bd2023b79ac837b54abb2ca345e3'
            '74c643e66a386c33d34c9f8b0d08697a8ed6b2e32f824562335f7d8f62c1e8bae921afdf5142fd512f559a1e0318deac15654a1b9d7d1206ad62080b50378abd'
            'bdec3b194a9c74465f1dea2fdaf815cdbf5affe74717b29060b2a6c5b17caaa60ebae69aa2df4d5c886c48a2c78bcba763d807d32bdd7fde32cc5095857554bf'
            '44bdd382ec8588456cb5c2fae141de0a902ceb7e4b4771fdaeb4f140adbc8fcaf1fb294a62a552372b3419d34ba1dc7e30987b8abdb5bfd0ae41e820d3688488'
            'e42bdd0e660cc961348f1bc6079bec2807ebc26dbbf22e30ab2cbe9ec5caf1b1f1ee37f96b7d17efd68fd1e8803b48fd7e9c1ec368de60e6d1dc749f5f6fbd03'
            '30d6781b4a782af9c41e287b73cc7c8d031e02ed0d521eae18ebf2c7e0dae7ed56df8a3384455bc3ded738c8595053c4fdd92020ed003d4c0f7d576abe6510f8'
            'a677c66acc63b03220e863daf96deddcbcfa418681e0547e4a4019940bdf60ce3b193ce678c4b2aab2beff3e6bbd8c301aff774db191ec8dae50753d71e4700e'
            '56eda466f6761aa7a5e70f4947c55724023671346b98775d84ff1b4b39d524c0f313f25a28391a5b94ee51c7343d6a1a494bd4d822f8fc87282d0c033fc35c5c'
            'cbdcc7f00c1a6741d372d23714863ffc282f6b2a924e53e338db5b32a9725c3abde15fd8e6666907e4af2ec4b8f9fbb1f7e4c522fa2bd8956e0e44171b89c0c2'
            '4b44a2415559b9abe68bea4584e60a27d958516993f6ee1283f9348a1a7379119a37622292533cbb763846fffbcf5a5998ff97ec94f87e6c7999fc93b42af10f'
            '431f7f7fa069f09b8ee473ea17ac5c40ed0e602591afc909ee5f532086a56ecf7ff234fdc8040bc929e9b4b8f41978e12f08936702a865898b2a30627cc967d6'
            'c0a0f4c5b1e92ebe1cef4e0e0ec8d10987e8e9b7e8b0138b23c7c3702115c3b38026f95ee667171b6b366dd8c4caadf519516f87a828a3d21533a661e5a22119'
            '38810b5b2c7f1b4a331909314ee1ece363a72d770b94d430567562187621f9e2ec1958d544fc2b0f1626ebb278c341b80c5cc977b62f5134a134f51248a0b2b1'
            'ce3785cee21277e6fa4372a454d247d1ac48e0d8eac05cd59ccce56153754b32b11f4d48e74bef0db1bc36b43b76bec7d0a5abfd662e38b7ecc7f396478de073'
            '7f001431afad7419c027fd69a08a375022da5ddee3dd6ca527dab931ff388d30813fd6b4d129443792ed5ea09f551f7feb9450c576e647c0b453d5ab5499b8a9'
            '8baabc6ff2fa11e1eb4fdd32420f0fd918cc9fad1563d82ef2a95512daab2b9a4b8ade8797650e8a18dd342e171fc419c363cde67dddcd53a8b2b4ae8839f727'
            '5a030e204ee566d5f52afabf58370d36ad5e9c828f5bb8d2c5be1e76340e488c033a7738d1fae40bccae18a7af052ac5d6b6b24083e50a31b9f932717f4c14f0')
noextract=("${source[@]%%::*}")

_lc() {
    for f in "${@}"
    do
        n="$(echo "${f}" | tr 'A-Z' 'a-z')"
        if test "${f}" != "${n}"
        then
            mv "${f}" "${n}"
        fi
    done
}

prepare() {
    7z x -y -bd "ThunderbirdSetup.exe"
    _lc "core"/*
    sed -i '/MSVC[RP]120.dll/d' "core/dependentlibs.list"
}

package() {
    a="${pkgdir}/apps${_apparch}/${_realname}"
    mkdir -p "${a}"
    cp -r "core"/* "${a}"
    rm "${a}"/msvc{p,r}120.dll "${a}"/maintenanceservice{.exe,_installer.exe}
    for f in *.xpi
    do
        f="${f##*/}"
        f="${f%%.xpi}"
        cp "${f}.xpi" "${a}/extensions/langpack-${f}@thunderbird.mozilla.org.xpi"
    done
}
