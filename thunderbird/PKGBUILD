# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=thunderbird
_apparch=32
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
pkgver=38.6.0
pkgrel=2
pkgdesc="Standalone, easy to customize mail/news reader"
url="http://www.mozilla.org/thunderbird/"
arch=('any')
license=('GPL' 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip)
source=("ThunderbirdSetup.exe::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Thunderbird%20Setup%20${pkgver}.exe"
        "ar.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "ast.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "be.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "br.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "ca.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "es-AR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-ES.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "et.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "he.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "ko.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lt.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "nb-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "pa-IN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "sq.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta-LK.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta-LK.xpi"
        "tr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "zh-CN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
sha512sums=('bd510c67bce94b3d651f5c142d31878e609f033237f870080c076ba3877f48b5d5922c5b0a8aa8f8fa126753bd01f46ab7b562a105fbd44194908e135e15a601'
            '2505080d944d2ea6b1374c8118e85ad20dc6a5480085c606683b0955acb5c0417809c15d4b5025c17f9b092fea9ee8feff7a712494fc9c24a2fa3ae23ed6690a'
            'e7cf1f9b0111a662bc2630835c5a1b816da3f7a581121fc32e533e56dfc32c7719d1872e3caba300b82372759edb688c2382d95066d319311a6856a84d8bd85c'
            'f43e5ea6a00f9876b9dfcde1759af2e10aeaf0161a2748341f927586f806a079936aee3dda1ca44a16624b145c9090bb98e119dc9d7c09ea2f6595dcffd3e95c'
            '3c8bb5f4ad41369b7300ebb6f0f874173054b637b4fdcac7ccc987295bc7491b3e8a8ab384d0fd8b40c8b40e384a7857c3ad838dcaf49c562a5a9ced234c4f53'
            'b9e08b8af61f3bad89a7fd47f51e201e744eb4e3fb065ec2193b92622afb05c283e337e2e5aba9427e0311fb0617b8068920fd82d691797f98f83d2aecf2170a'
            '94bc520bf34f79ac15d677cd76b9a13fe9fc219179e4e40a5533af4632ba941335704119f6c62d35403ad72207aa9d58ed180e86c2beb9c053f4134d6a5db1aa'
            '4e65607f2d34accea4f36937dbedfe12e94dae6e850441601842b927108a59089778083740eb29b08210f3e348858e45fa28a0cbd193df1a2c6075d9332a5fbe'
            '90100b2c57e84659cd6593d37827aa6b7258707ffd0944937c8ab8983abd89db4dbb2e921608c64d51639f5cd3da6db5689bdfc7d7aedbe5e6f2e337cb868e00'
            '58fb67ac67295a056502645483f8a8aeff1278100f935137fc833621980c064e6a2b2264e8e081c47224219bcf23c86d13ce8293b6d83085b4dc7b131cb0e687'
            '47cbe743c3cf0c2e770f6cae98b6a2a39222609b4ef4d32f9daf9b56a3fcac41874ac07daf0ed376fbe32b49c9c1fa69719677a35c0e7e0b8c3d27731bef578a'
            '3028a3163874c0b66cd7695d330da0ae988122c9767267cb6fd70e77673224e0bc3c4f79ef944520459bf0ac7acd5bb4f87761559e9fd43db3c614a397ff7e32'
            '51ed1b29f4ef41ce4633d3ac0dc07709c99729c57354412708daf3e44e95bd59bd62580afc4f525e93e632a279cce29460fb65919a2b7cc59fbac9d0d2bd43d3'
            '5703e31ddd82ba278b53f5b4c5b8295478f0794ba21c2cd4970cc053602ecf5fe203843c9a53a5347adc3d945ca096ecd705e1c8dc46a7a02b1a4d5ae7d9c90e'
            '87fcc4b296dec040fcac66cfc9a362117e1e0d0d2223c7ba316d972b200f8b1caf52d168be8a826b50a2df38040c2f96f2b5520775b18773e9409e8d2f0fbdde'
            'b3071304eac02780e649ec4e74701b0604288d9936751a1916112b166b52c1e4c98b5078b123d8f194d43adc9a6a3fb0f41d8160eba8d6e121d0442ba794ee46'
            '8d13b9eb689d7ce603a635b6f2df4d3c7a66834e903526570088e43710f2affe0f7f5747f127c7ca7b587f1abac20ae6301031cda72f443bdbc75cf2b8965a8c'
            '00efdaa9b3e680edc867e1545b012ff7ea85c8a71a2ad6c8572d76b4fc9f65f51f1c228f591c70afd81826537f02a5f3ff585875c5fc44efb33a3f1bd017466a'
            '400d68511353cc263b5a4db7e7f82f97811942008e252742a5fe4ff93adda874fc9a864427bf8bfd2ed1d7102a34b66a9117c7ee88fa49de1a8908451db5e8f2'
            'c3070df75b685ec1122becec00d9cd98950525bff223db65a8e504c7b4dd7185789bf96b7f898322e65743cf0217c60e2d07fe648af3cdf2e8319c390ad5155d'
            '478f127b2e1adf81f512cf40d0c72d5f331e54387533857ed5a1bdcde2910ca4e909423e2c8b152e842426c997aa36692da0d710665898241f3ad42f44b88b00'
            'e1debee23993bf0569b215563e891a2db595a1194544f97228f0173ad7e0049c56e1b735f6ae24a9604f216eb21fcc308fca5f5d2d617afa5bc9bf118bdc1326'
            '2911b89fb4984cea0af6f7023f86ba906ca859478e21867fcc4de77afe7f9b6e0c958186158cb93d72254ca0845ae705459a81988e5c37c9227fe0c626a00238'
            '1992d90f01625e80c7dd452441a99f616e2b538797024f01929923e546ca3d334770eb6ed232b05fa800c9967c6f9dbea2a6b0eb4341a31d762ac0590689d612'
            '83d76c31bfedc98849f0d5d2e3e7ae895228b9be3fb11333fe501b4c0c8075846724042711495ee68aab87360c4bdaed7281468d0ebe9b1b8ae07e82e9eb0e2b'
            'e6f84ccf159c370727c75b5e6c4271d38d7c49a3c872c195366be2c46d6174301cac56b61ed1b2fc063e79f7d813ecb0a05942d1e6b64e1c29b7855d56fb4d35'
            '39743cf4eec48d27a1cb7a3fe9988a03d45bd7474dbf5b952b5e2ea5b5340e9a7a434d5f15fa5a384d1cdb3adf0848db5c91afc061b38957ca185abe92b880cd'
            '38f7c2533cb0ce434ff889a196b327e19fb9489bcd809e7b0c29d9cf5f1876367583a38b8faaf962019689caad0eb16b96d1eb8e6bd9aaa8e05909bcda7480f5'
            '5c1ca136843b5167afa5e32c9062c504bddbe4f238524e8aef869befaa2c730f78950339a384933e4f3bfa8948cb99ab39690cc755a05a9858e7c1da1572bb0d'
            'b91eff5755c5666842072af6148f8987144b4dc4e12f5f3a7112064d8331ed222f5e2b8888f66cccb570a2d6279fc2a83ba13e4972a7e972d9ccdc0ea28de6d2'
            '6f69d2e25cf87b41c001764f1f2cb333c8ab3912d1a600211a37ab30043291da47c22171c1074d0185fa09fe6700c54cffdca2444422b183fc2eba05545b8f40'
            '44db4a17e7ab8344fca14605f61902d406f699a6af2e65e683a5c8a88a3e4a5f1728dbaa0563ca22f8fc820b83a4ddef95a7167a7bbf0dc70a5459f4a71b2eba'
            '09dbc988fbb21e195e26d51950097ec8aee4c10acbad8823a5531261798884ed8a811ac826d5e96bba16bd719dce08d1414cb89e6b1be3f9cd231a2dbb6a9ab5'
            'b45a295d499347ec313e849c899595faf7df54bc8e278252b440286c3cd6b48e0e0c0c039c27482645ca78977d0c4d67eb7fa452ef795715ca6d2747313acd7b'
            '34e32fd31ef26d56e82a052ebd3f611d78a3539e010fb332e21525ce564ec81c8c23f1b0119ba4788bd5d1df22b60b67b299e0b02bf03c6cd76c337c94507577'
            '4c57874701d72b39c9b1eb793853b285fb8af2c8b5d5f128e5a51de48209a5f383bec31439569f5f5d20340efdf554f78e2a02221a6469d3049f8f814ce5d5f1'
            '55b2ba65004e54271a92f7a04a13cd0bd2519a6ba5223be6024a689527d700e8fa7a30b2a0011161851f2f0d9b15c9591668013240409a2b7592e7efbb034de3'
            '7c6485007d9b06c3503f9a15b4cce4851ff1c4cafe14490ab142e0e3ccfac3d7b7094dfbcc3c5ac9879100e9327a000e92c58c1635ce0557cc0c863a9180dce6'
            '8115321e611ce990d900564ff26a27462452c32e2740b100a31a6456f3cd1ca24bf5f825d6877d2315ab7f3cf1a59db399fdc12d5bcad1b92592fa2598e8995a'
            '031667f973e57017d952f5867b40201f47c7f16951f7cc0857c909497fad5fa66a5dd42a939a0aa0f52f09fd2f8525a4326da718f0bee09d840e89c0f2e192ae'
            '877c5f2ede39859f697a7df8491db14e37d9f3eadefb92884f9606875c75131be784dac6988e245b1ec1ee1a19a35a5bbf2b258f98b92f697ca924f18bd7e4da'
            '7b6f699e2ad4a3ee744cc8f0f8a2b16bf3616b37c128687eae356fd77042981a55aa6acaf1c2e018a1cb5861d6bd4147718d56fa8694fdd9f422d2dcbc468d9f'
            'bccf8a72638239f3446763feca79435f0bdcd3477cfc9c900cf59ae6a427a8f3396e2c69988aef43161344abe43f26c889becd4bed8372e35859d12f706635be'
            '438d836ef6366f3ff8014333cd291d940e65c20ee08a34b49b1d188d7f9807fe3895deb37aeef0dbdb7ca6442451426ba5040951e927572572ad09eaf3ea7990'
            'b76a200725a8ae0ab889dc6404868fd50894b57a4347c7d2dfa360528319c0695b3e304637172530d4b587cf4a0f312ad1d02e216cca35900eb3fa6f5de1ccb4'
            '9669b3cfe425d9f2e21299719d5f24ab40504d8fb68566d3fa180bc0ea7f64329cf8712830d893a3f6d5aaec0ff82a5fbdc9c4792bc18c24c6054c9899764b41'
            'b41a1bf6116cabd237960400ccd43531bd4b72b2069f986794eb3b2a356a69bc309a8c24d56d095e82e2a0726f9c025fb461375e3f7f0bfb0920fc4bf7195d95'
            'd7442e1a411d79bc74334d724a97b52e7537ef181fb94db12d5a405a73f414120d35603680d619ab1e2b81665b797a06d95961b27baca36cd72eee52da99201b'
            '975371924edc6c90967ba461331763b5f9ba6445600eb5c0b20b0ed99f8aad1639779ef14f37345e87731f62d6dc191917d7473af8cdfa0995ea114faeb3dc1d'
            'a376dffd6bea05c6c3d5bf2e562d55b2ceb29ba4a47f777b161c040f378a39eee4e6455b05e0b21abd8501eeb93246a93f2c9ac1c9a2064ac0077dcbf2dbbd23'
            '95bfc1852131292285c422dacc39935abbd5c9253c287810c2f9ea67343c4a176ada4505907aa665ac8723e031ab42e41f26ea3eadde2b39d1c40532cd6d8e62'
            '8ab0a6ef4702b945268191437373bdd99513de6d77bc70a9bc5ee59ddc22850598853f5f58facebbecbe7e113b201cfdfc59772009205c824fa31e0e5a1ff373'
            '0724ae37e2c2b455ec091e59ad7d3f129db40ad1b52322033cd44d3ce0b1158610bd3dd9fd39b5ea6033169ca37b68438c8f1cc8911ffd8b0a0d33d059037dbc'
            '10551ba8719f57d12a764a19d7261f3a1734ebf373b397caa88b5b9d0a98b9b8fa69cf32f7624eab375274bc318a57bee1e117b22af15c01694fe79ebccb6313'
            '4f4ad2cbba2f217705f1450d437ed79a294dd45d992174dda209d13199a05bff77d555c68712207b460df26e7e5aea4c5c72629bed9112f104feccf6f7886b0e'
            '2c62685a9690728296f2dde44b5675661734e8cb7feda55a653a18e9211b4f2c1aff292e56107d5ea54bebb3fc560ac6c0c8dd1e667613f31caa1669e0cba35c'
            '20546a1ae9dc49452c8c58550c94f8f8fa33418c7d860c360753c180b134e236f36a699e36983aed9e26caf5a2e0ae6ed8742381676087a406e58784d452a412'
            'ab873cd7b28cb8d550a5d1c480bcfbb9f452dd44893fdb7a4d483caba65ece034701bfb4a7211c285b49ec3eccd7c6cbf900a457eaff5fe12c475c7157b5b3e2'
            'e1b961930db447cf4e062282a5f24b1c7d71cb34bffa5f45ecbc5852491ba11272ffefff13b1a390785807aa12fc11598ac11e7f20819e007d2bd4d290db4477')
noextract=("${source[@]%%::*}")

_lc() {
    for f in "${@}"
    do
        n="$(echo "${f}" | tr 'A-Z' 'a-z')"
        if test "${f}" != "${n}"
        then
            mv "${f}" "${n}"
        fi
    done
}

prepare() {
    7z x -y -bd "ThunderbirdSetup.exe"
    _lc "core"/*
    sed -i '/MSVC[RP]120.dll/d' "core/dependentlibs.list"
}

package() {
    a="${pkgdir}/apps${_apparch}/${_realname}"
    mkdir -p "${a}"
    cp -r "core"/* "${a}"
    rm "${a}/searchplugins"/* "${a}"/msvc{p,r}120.dll "${a}"/maintenanceservice{.exe,_installer.exe}
    for f in *.xpi
    do
        f="${f##*/}"
        f="${f%%.xpi}"
        cp "${f}.xpi" "${a}/extensions/langpack-${f}@thunderbird.mozilla.org.xpi"
    done
}
