# Maintainer: David Macek <david.macek.0@gmail.com>

_realname=thunderbird
pkgbase="app-${_realname}"
pkgname=("app-i686-${_realname}")
epoch=1
pkgver=52.6.0
pkgrel=1
pkgdesc="Standalone, easy to customize mail/news reader"
url="http://www.mozilla.org/thunderbird/"
arch=('any')
license=('GPL' 'MPL')
makedepends=("p7zip")
provides=("${pkgbase}")
options=(!strip)
source=("ThunderbirdSetup.exe::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/en-US/Thunderbird%20Setup%20${pkgver}.exe"
        "ar.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ar.xpi"
        "ast.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ast.xpi"
        "be.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/be.xpi"
        "bg.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bg.xpi"
        "bn-BD.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/bn-BD.xpi"
        "br.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/br.xpi"
        "ca.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ca.xpi"
        "cs.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cs.xpi"
        "cy.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/cy.xpi"
        "da.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/da.xpi"
        "de.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/de.xpi"
        "dsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/dsb.xpi"
        "el.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/el.xpi"
        "en-GB.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-GB.xpi"
        "en-US.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/en-US.xpi"
        "es-AR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-AR.xpi"
        "es-ES.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/es-ES.xpi"
        "et.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/et.xpi"
        "eu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/eu.xpi"
        "fi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fi.xpi"
        "fr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fr.xpi"
        "fy-NL.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/fy-NL.xpi"
        "ga-IE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ga-IE.xpi"
        "gd.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gd.xpi"
        "gl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/gl.xpi"
        "he.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/he.xpi"
        "hr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hr.xpi"
        "hsb.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hsb.xpi"
        "hu.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hu.xpi"
        "hy-AM.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/hy-AM.xpi"
        "id.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/id.xpi"
        "is.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/is.xpi"
        "it.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/it.xpi"
        "ja.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ja.xpi"
        "kab.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/kab.xpi"
        "ko.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ko.xpi"
        "lt.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/lt.xpi"
        "nb-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nb-NO.xpi"
        "nl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nl.xpi"
        "nn-NO.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/nn-NO.xpi"
        "pa-IN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pa-IN.xpi"
        "pl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pl.xpi"
        "pt-BR.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-BR.xpi"
        "pt-PT.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/pt-PT.xpi"
        "rm.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/rm.xpi"
        "ro.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ro.xpi"
        "ru.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ru.xpi"
        "si.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/si.xpi"
        "sk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sk.xpi"
        "sl.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sl.xpi"
        "sq.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sq.xpi"
        "sr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sr.xpi"
        "sv-SE.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/sv-SE.xpi"
        "ta-LK.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/ta-LK.xpi"
        "tr.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/tr.xpi"
        "uk.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/uk.xpi"
        "vi.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/vi.xpi"
        "zh-CN.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-CN.xpi"
        "zh-TW.xpi::http://ftp.mozilla.org/pub/${_realname}/releases/${pkgver}/win32/xpi/zh-TW.xpi")
sha512sums=('ebf115d7a253f4e89f2528687855ddd2200421dc045c33549fe9bc1221f61ab3e9c5b86929fd9a9d89be99b2cbaf552d912bca3fa8c4df2f6223f859064f3c83'
            '11b5e7d04d08eb73a8ce8407b262eca3e152c30bc4239043d86b747da48c9e3b40a1ba1bb0e6c21ab359469484a8f0e3cc448e674709049e29fbf6b7b716eaa6'
            '6e28ec990b7031e3de9964a80f6a8189f9860dd5b23374d884901c9ff6579ac5b53548ea52a122e07ed4a7c1b0abdfd5eefe9ad22cecedfd06ec7bfac6454b30'
            'c44b98c0cf7d79c39ace81d8ae1730e7c2be931b1aec399f2edc1c00b809a405859c0d601567ff71156ab77ab7a3738db7bcf0790fef285d8b23c26941d27d1b'
            'e2adb9320868ae28fd66785922d5e0a07dea29a0c3e07b85f759f9d567d1739e2756bb7a9a3d8bf5119614c8eb686ebf7343e7b7d6e0a239d0f132d7f3b278d3'
            '76c372e72d04bba520bcea9393f2ec9b1df566fa9946e109cc953638bb0566c5a19810008265efa2ad1270d47e662415e5b81d3800fe059a16fbb742c3b04e1f'
            'f55418b006f382b78ee6fed9371731dc2e073c56ff7cd49467aa6d087462c85206b8292bbe65ace358447637a5bf93cee23c81ebe9ca81e89734a35fca7e1403'
            'f8c92b3cfc014920dba51e95ae8b6350387777d94c0d1677befd90881a01fb741ebc5b176234b43840beacff015a2a5d09ff9c688ac76d4b2d794ea0e3444056'
            '08313ce88ba7f691acf283335ed271db2b495ed27c5cce1181f23b48e1584db0972c95ebee0d8b9f7defa8b03df94aa8f38ecfb8bb8a9b03ec51a4ea13fea854'
            'ccaca126f141a1cbadaa0a6b9a75e0177f7e39a500d547ec059db6d591cc2c605c7a6c5c2491f5eb739129429ef2f95104171f36bacf678b26d871d072c65c9c'
            'b5ef7f000ddbcab110b08ca07be7f1e66f1a275f8ea622fc881d2a240afc1b1de492d2bd0775b0fa13c5e38a41545f0750db9200bdfad9963a97db3f2655babb'
            '56e4fc6f012eeb97f6d8d82c710b5e0f46aa77b6b6eb880d85977ac1877181961e2592e210ab88d48bb0b0223d79d35919d648b04a03c0b452b716f70fc898f8'
            '704d6797140a1fafa5e5099b8306990fd9bc98ac719f9a5c5c19dd3ccd34f8924977260747b33c5e9d01312f2cf08125308ea048c625ccaf3b08cecd842c31ce'
            '75bfd1371010a0a5d3d67c8f456196c27e9d457ae0720b4c197ff4d986e0ec8982012595700422ca010b2a835323c6d3087d50cef5bcb34d8ff160832f00ec24'
            'fc08919322d82c7209d0ab885f2549f7585ea0cfd5e4658e98c571f98f554b2a94418deaa0e34a6f173a8dae01a6a4882c3a05ba0e6add58e1b6d9319095edd9'
            'c10024912f6d07a30f6d012649f2b8771411454f2ea1248cbe9e67836810f451f39104e2956a2f161062da910987e0254f931032054b3afae3b251639f021c55'
            'becab26a00fe96d58f9f67708a4510a8e882d2fba3cb46ed87f1f77fe8e955bfed55809ae8e76d2a33ff49f856918105157515649b24f23c0e4c30d56dae631a'
            '2b6edbd04ea220da589931e88381d5fcba219404f0c368b88d8094ccf5f3bf48d8513703aaf62660abd7892dde70ecf93a1bc8f472fe5a1f6edae12d0c148e7d'
            'e00dffd5ba4dd013f0b50cfffe6ff97f3470d77d4d68fe32344ae13bcf2671c7f987626681149984acc854c3d473ef3831b2cd271bf362ebf1258ef9bdaad523'
            'f6642f07f31c42f76f3cbf61114db9a9f5439508a589c4893716243d4ad5d6fe2baf1b6409f8cb2978212196109b3fce72f610a5818086585d97f8afc825b999'
            '9faa7e222e3004c5174dcf90ceb0c8a686c5960e43ce5bc0344c0d66d0235239468487ad99ac5f1bbba781c4937d65b75618656e8918c8e014b5f78f1f6d24df'
            'c6164910bdb67632536bc3c36785727972a7a524107b98cba5266f14366250b4eeefeb9070ec3029d75136f96a65a00df77a08e9f7aa0d5c9b98e0514436710d'
            '54fff499b0b0f90ed224438e78d9fab4ab9f1003ca299570fc9d6d22a543943e1659ce689309604633b9f12ef153022303d53bd1ad28c0c66eb5dc044ed67ed6'
            '9acd63118a015fb3d77a4b736649fe6dee3a7741ec17301e76b9c7c691f0b7e9e8f9dc4802838926082f50bd0b7154d1cef6ebba394dceda0243b6f4c08056ef'
            '52c4b55d4de19da3020b5b84d03d7bd1cd3e702613fe83f3237c6ecacdaf0e02a40fbf353ccd0da038b94a662c9e9a99ec4a6a0751d615b4580088b1db1558cc'
            '1e54efb13f6bc19ab2abb3684bfb388a63d36770a551e490a67524658dbc1f069f03266d089716dd4865f643e174c3806c7ebb0bdbfc0bccff9b53f930a13857'
            'a10d6fe4bc9abd5ec688a34ed2eec60bec2e6589e9ac0984b6f4b5aa739dbedb7d1430d753c00a356bc1ec26d8ad790720c3b25ab7e945397bbfdef830146447'
            'cb0b3bd3125d45b1814a7eb09408a2a04b196a220a0430ee0c89b6bc9c29a5d620239714d725ce1d35d6aa6a1b3e5abff4ecf396c7e56dac8d69128488879d8c'
            '1e79a6280d50286dc4a454a67a4b2630ac51890bc8e1d36bdef95580f7f2bed5553bd03a751ee6d5d389dc2c2aeaba3c1d6365753bdb7bb49210ff25d749d544'
            '6cb9eed276bc6917dacf42cc70662eff044a114a7e4972b69e2a7133253c12d6b321d59a057c3e20ab36487c275631a33e065e2e2e2bae3d098286534413dbc3'
            '9f6c0ac1e8ff3e90e1290a78fd284d9be1936ee0ec7c66d82d8fe40a0e9ec6d2b21b4c36f94c1cb255783258fcf316e6635a38b6d3058efa2c089863e8374487'
            '4b525adfaa8e66814a5cc78d975838f0fc544654154bb92f7f032717e647cf1047ff2206b2ac480181eda25be5a6a96db72ad267e008c8be941bec206aa084ec'
            'e30b740be7414aa2823eed77faa9cd6f0876fadc475dbffee915154dfb6f0d27d5cecd5ac4503e7d65f9304b9405eb0673e7aec4868b85b70f84c9f9457f4ec6'
            'ea24cd9fa6d16c977c8d4cd0fea879261339bdfa1659c1a569b3849eaf60a60024839da81328758321fe70867005f752573f34b8892af34bc95a1aa6f41df1b0'
            'a826a91c8ba9b818ab70921a161a658e6ca2de6be0b98a2e9876375606ae795ae80c2a90439a7ec28844db17a9d5b8514582ce3209f76b7634a3d27da09bf101'
            '1cd304bf5d4ce44c7d86257ab0dd55224c098fbcc2838f72c30c7075f315eae718985aa3811e9476514db4ac6414a18412cc071943c92e0eec29c59382d6ad75'
            '7bd004dc00dc703a8c4e0cf198647bbab5afde935db5fd2f13b7eedb86b056e7ad924a5b172d30b1558ebbeb9050f1859483c5c20082ff6fd053a24d904d0b9c'
            '47d084c046af5efccb5553643e2e35279be8cd28b2f22cbb4e8a2e75a045139b73213c10d5d89bb983d7f0e7ad8de16d32ea5219fb0ba007f951f20cf0740e91'
            '5481bfb1ae1865d15b8a167745ea746ccef2483343182b9c562086398b0320e147806717aaf4d31a22b3c5548fb2448d95af03bdfbf9ae3d6d24e68e0653f557'
            '546b0dfa781201a3e922aa5575bee517cae8438fc19d2751d623173a0b31ac46ab563507b57cde5322e5e033e59bf514b3866286472a8cabbc4954f371342ae2'
            '7d0fac31faa31f738fdb4c9568aa83a9d3b3ea8bf033d3e1b33a241daf7be1cdae9ee96cc066eb0188c4abc63c790ff94c67b70d2482e18ed41135e945513895'
            'ef3953808402136cd737ee20f9bbe4e0ccc88373de0dafc6a592e594fcae7eacf557dd5432ee059f2d36192f671513cf2dd82d670c6a497d6c2e0ecbb8a0c2b1'
            '821ff3d04e6fb8d7ecdae422d44a50c1f59694162c68dab7846d2cee6e586361d5ef9296f91bcd90fc6a134e886c4946b19e3b27e0c2aeb3df534f6318227ad2'
            'aa2a4d8e7c70d2326ac8da45109f965073850bedb3903860cfb4e94175eb171bac395e33fe534eec41f9b1c9971589b5daf5c382f245476cecf1819c3115af41'
            '9411d6af7f55fd94a299f4fc76cbb3f66bc4975083a5e5a332a6ceabcecc1052c2b812030a2c4c00ccc1215cb631aae96e37059b0c64fac464d2ee311d3ec398'
            '5f07d6d1d03d345390fef438c7687f991b18ac933451aa2e3a9cc97f7cbdbd553a5d47bb4f2dbd6aa16f3c083b70dd785c685e026175e420b1c9f2235393694b'
            '9e17a225f8db333c4ea2b426630ba7672676967bbf6d31efaf692ec9b3ba4e9c4e86efb23923fba05c9213d72be7c8dceeb620e6575c798766132d0fac866ee8'
            '4f4d79981b0fdb5895ca820828774ddf8ff5746061bbd64d7ffc306bdbd279ceb62739f47f890695191c597f4b06b563d1d64c36ae046acd88efcbbdc48b1fae'
            'b79148fb07d899a48915253ff969ac941a1905538373cdbcb23b8073c6dad9ee9b6ea19714e6dbb52c2660f4b570f2667ff36a3f8b0d8f28d3e621e6c6564b9a'
            'cb4c408b9b52bd3d24bc0860e802f3da203bc89b9111d590f45e7c5d0add31d0f608d1dd4df753ccec835773df32bdc83698f1666d70e18f30b4a7bf98092b8b'
            'ab986a650ebe12828f2e6e51d5704d9d74a3f71e4873239acd051ed3288fdce7183661eca28c2f7c70e40422370a92fac5eaac4ae9f053b2aa95a28c982409f3'
            '476da127b531ce59a2eae4cf22687c9d511a510833cc2dd088a3d141e9119524beff5aeff4b6d4b43ca07fdde0113036eb06fcec1a85caff36df2507c6a43896'
            'dc8e965be17adce018afb22d239a8e4d632943141fee7727721f6092f85c006ccf328bf52d02d7487341f418f96ff4c2aa5b49e7e4335da31ac7d6a2b7bb778e'
            '4543b7af543c2f3c275d2487a08046657056b7825ca79e094c4edb5bbc0a3c53cc6b06ef62f6986e4889f5de88589cc4fb7a3cd2b1b1405e7eff3f2469b23911'
            'c4cf1b76f45ac8dd1fd6b7fe05f0fc8972e45551aa52bf1862cb8a57d7a37e2a56d2960a2a00bb12f56f6bedf4f44e5e1228d7916f9d92f11a1290609303d55b'
            '087b2430aa89a979d910309e70900d1c5c711c1322ab44c797f61375dda7267c42d555e8357baf149640c6896a31f2f15b150c231986b0c7a7055d56f0912fe9'
            'aa621a6075eaede9ea86519faea2b4a3d1edc55964c7cee26cc818e2e631436db1b3ca8dc446af0c338602d7772e01cf88c48111b769ef64e1d215f1445f87b7'
            '140fc71db6726d9fcaad9f5fefcd907bdcc4c4cd09de6ecfcf8338d6fe6c07bc2fa6d32cab8525f35e3fd4ed9a6927924fb1d7cb7ab6cf8bb138f4249ebdd1c1'
            'd5cbce9abaeb212bebfb27a6f3ff07922f305e7b41c064f6525c4c4dd9d9b9b89a0d57b3a125ce342378b670b907a0630256485119fd33c21278b2d786925451'
            '59a9ba7ce7e68fe742a82e076f6487e72b1c4d8a9859e63b5c03c4c803d8fb8d64173a53c98877ae3bc7ea89cf5d2b4da5df706c2947267290d78eec9b4a8b16')
noextract=("${source[@]%%::*}")

_lc() {
    local d f n

    for f in "${@}"
    do
        d="$(dirname "${f}")"
        f="$(basename "${f}")"
        n="$(echo "${f}" | tr 'A-Z' 'a-z')"
        if test "${f}" != "${n}"
        then
            mv "${d}/${f}" "${d}/${n}"
        fi
    done
}

prepare() {
    7z x -y -bd "ThunderbirdSetup.exe"
    _lc "core"/*
}

package() {
    a="${pkgdir}/apps/${_realname}"
    mkdir -p "${a}"
    cp -r "core"/* "${a}"
    sed -ri -e '/(VCRUNTIME|MSVCP)140.dll/d' -e '/api-ms-win-[0-9a-z-]+.dll/d' "${a}/dependentlibs.list"
    rm "${a}"/api-ms-win-*.dll "${a}"/ucrtbase.dll "${a}"/{vcruntime,msvcp}140.dll "${a}"/maintenanceservice{,_installer}.exe
    for f in *.xpi
    do
        f="${f##*/}"
        f="${f%%.xpi}"
        cp "${f}.xpi" "${a}/extensions/langpack-${f}@thunderbird.mozilla.org.xpi"
    done
}
